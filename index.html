<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="img-src * data: blob:; default-src 'self' 'unsafe-inline' 'unsafe-eval' *;">
    <title>ูููุฐุฌ ูุฑุงุฑ ุชุดููู ุงููุฌุงู ูุงููุฑู ุงููุฏุฑุณูุฉ</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Cairo', sans-serif;
            background: linear-gradient(135deg, #004956 0%, #d4af37 100%);
            color: #333;
            line-height: 1.6;
            direction: rtl;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            background: #ffffff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            border: 3px solid #004956;
        }

        header h1 {
            color: #004956;
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        header p {
            color: #d4af37;
            font-size: 1.2em;
            font-weight: 600;
        }

        .form-container {
            background: #ffffff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            border: 2px solid #004956;
        }

        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #d4af37;
            border-radius: 10px;
            background: #f8f9fa;
        }

        .section h2 {
            color: #004956;
            font-size: 1.4em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #d4af37;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #004956;
            font-size: 20px;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 18px;
            border: 2px solid #d4af37;
            border-radius: 8px;
            font-size: 22px;
            transition: border-color 0.3s;
            direction: rtl;
            color: #004956;
            font-weight: 600;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #004956;
            box-shadow: 0 0 5px rgba(0,73,86,0.3);
        }

        .gender-options {
            display: flex;
            gap: 30px;
            justify-content: center;
            margin-top: 15px;
        }

        .gender-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 18px 35px;
            border: 3px solid #d4af37;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 22px;
            font-weight: 600;
            color: #004956;
            background: #ffffff;
        }

        .gender-option:hover {
            background: #d4af37;
            color: #ffffff;
        }

        .gender-option input[type="radio"] {
            width: auto;
            margin: 0;
            transform: scale(1.8);
        }

        /* ๐ฅ ุฅุตูุงุญ ูุดููุฉ ุงูููู ุงูุบุงูู - ุงููุต ูุตุจุญ ุฃุจูุถ ุนูุฏ ุงูุงุฎุชูุงุฑ */
        .gender-option.selected {
            background: #004956;
            color: #ffffff !important; /* ุงููุต ุฃุจูุถ */
            border-color: #004956;
        }

        .gender-option.selected input[type="radio"] {
            accent-color: #ffffff;
        }

        .gender-option.selected label {
            color: #ffffff !important; /* ุงูุชุฃูุฏ ูู ุฃู ุงููุต ุฃุจูุถ */
        }

        .committee-selector select {
            padding: 20px;
            font-size: 20px;
            font-weight: 600;
            color: #004956;
            background: #ffffff;
            border: 3px solid #d4af37;
        }

        .committee-selector select:focus {
            border-color: #004956;
        }

        .committee-selector select option {
            padding: 15px;
            font-size: 18px;
            color: #004956;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .member-row {
            display: grid;
            grid-template-columns: 2fr 2fr 1.5fr auto;
            gap: 15px;
            align-items: center;
            margin-bottom: 15px;
            padding: 15px;
            background: #ffffff;
            border-radius: 8px;
            border: 2px solid #d4af37;
            position: relative;
        }

        .member-row input,
        .member-row select {
            padding: 12px;
            border: 2px solid #d4af37;
            border-radius: 5px;
            font-size: 16px;
            color: #004956;
            text-align: center;
        }

        .member-row input:focus,
        .member-row select:focus {
            border-color: #004956;
            outline: none;
        }

        .role-label {
            background: #004956;
            color: #ffffff;
            padding: 10px 15px;
            border-radius: 5px;
            font-size: 14px;
            font-weight: 600;
            text-align: center;
            min-width: 120px;
        }

        .add-member-btn {
            background: #d4af37;
            color: #004956;
            border: none;
            padding: 12px 18px;
            border-radius: 50%;
            font-size: 20px;
            font-weight: bold;
            cursor: pointer;
            margin: 15px auto;
            display: block;
            transition: all 0.3s;
        }

        .add-member-btn:hover {
            background: #004956;
            color: #ffffff;
            transform: scale(1.1);
        }

        .remove-member-btn {
            position: absolute;
            top: 5px;
            left: 5px;
            background: #e74c3c;
            color: #ffffff;
            border: none;
            padding: 5px 8px;
            border-radius: 50%;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .remove-member-btn:hover {
            background: #c0392b;
        }

        .action-section {
            text-align: center;
            margin-top: 30px;
        }

        .action-btn {
            padding: 18px 45px;
            font-size: 18px;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 0 10px;
        }

        .preview-btn {
            background: linear-gradient(135deg, #004956, #d4af37);
            color: #ffffff;
        }

        .preview-btn:hover {
            background: linear-gradient(135deg, #d4af37, #004956);
            transform: translateY(-2px);
        }

        .warning-message {
            background: #fff3cd;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #d4af37;
            margin-top: 20px;
            font-size: 16px;
            text-align: center;
        }

        .warning-message strong {
            color: #004956;
        }

        .preview-container {
            background: #ffffff;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            border: 2px solid #004956;
        }

        .pdf-preview {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            overflow: hidden;
        }

        .pdf-content {
            width: 210mm;
            height: 297mm;
            background: #ffffff;
            position: relative;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            font-family: 'Cairo', sans-serif;
            font-size: 16px;
            line-height: 1.8;
            overflow: hidden;
        }

        .official-template {
            background-image: url('template.png');
            background-size: 100% 100%;
            background-position: center;
            background-repeat: no-repeat;
            width: 100%;
            height: 100%;
            position: relative;
            padding: 0;
        }

        /* ๐ ููุถุน ุนููุงู ุงููุฌูุฉ - ูุงุจู ููุชุญุฑูู */
        /* โ๏ธ ุชูุจูู: ุนูุฏ ุชุนุฏูู ูุฐุง ุงูุญุฌูุ ุชุฃูุฏ ูู ุชุนุฏูู ููุณ ุงูุญุฌู ูู ูุณู ุงูุทุจุงุนุฉ */
        .committee-name-area {
            position: absolute;
            top: 12mm;        /* ๐ ุงููุณุงูุฉ ูู ุงูุฃุนูู - ูุงุจู ููุชุนุฏูู */
            right: 56mm;      /* ๐ ุงููุณุงูุฉ ูู ุงููููู - ูุงุจู ููุชุนุฏูู */
            width: 95mm;      /* ๐ ุนุฑุถ ุงูููุทูุฉ - ูุงุจู ููุชุนุฏูู */
            height: 25mm;     /* ๐ ุงุฑุชูุงุน ุงูููุทูุฉ - ูุงุจู ููุชุนุฏูู */
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;  /* ๐ ุญุฌู ุฎุท ุงูุนููุงู - ูุฌุจ ุฃู ูุทุงุจู ูุณู ุงูุทุจุงุนุฉ */
            font-weight: 700;
            color: #ffffff;
            text-align: center;
            padding: 3mm;
            line-height: 1.2; /* ๐ ุชุจุงุนุฏ ุงูุณุทูุฑ ูู ุงูุนููุงู - ูุงุจู ููุชุนุฏูู */
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .document-content {
            position: absolute;
            top: 35mm;
            left: 12mm;
            right: 12mm;
            bottom: 15mm;
            overflow: hidden;
        }

        /* ๐ฅ ุชุนุฏูู ุญุฌู ุงูุฎุท ูุงูุชุจุงุนุฏ - ูุน ุงูุชูุณูุท */
        .legal-text {
            background: rgba(255,255,255,0.97);
            padding: 1mm;
            border-radius: 3mm;
            margin-bottom: 1mm;
            font-size: 18px;        /* ๐ ุญุฌู ุงูุฎุท - ูุงุจู ููุชุนุฏูู */
            line-height: 2.2;       /* ๐ ุงูุชุจุงุนุฏ ุจูู ุงูุณุทูุฑ - ูุงุจู ููุชุนุฏูู */
            color: #004956;
            font-weight: 700;       /* ๐ ุณูุงูุฉ ุงูุฎุท - ูุงุจู ููุชุนุฏูู */
            text-align: center;     /* ๐ฅ ุชูุณูุท ุงููุต */
        }

        .decision-text {
            font-size: 18px;        /* ๐ ุญุฌู ุงูุฎุท - ูุงุจู ููุชุนุฏูู */
            font-weight: 700;       /* ๐ ุณูุงูุฉ ุงูุฎุท - ูุงุจู ููุชุนุฏูู */
            color: #004956;
            margin-bottom: 4mm;
            text-align: center;     /* ๐ฅ ุชูุณูุท ุงููุต */
            background: rgba(255,255,255,0.97);
            padding: 3mm;
            border-radius: 3mm;
            line-height: 1.8;       /* ๐ ุงูุชุจุงุนุฏ ุจูู ุงูุณุทูุฑ - ูุงุจู ููุชุนุฏูู */
        }

        /* ๐ ุชูุณูู ุงูุฌุฏูู - ูุงุจู ููุชุฎุตูุต */
        .members-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 6mm;
            background: rgba(255,255,255,0.98);
            border-radius: 0 !important;
            overflow: hidden;
        }

        .members-table th,
        .members-table td {
            border: 2px solid #004956;
            padding: 4mm;           /* ๐ ุญุฌู ุงูุฎุงูุงุช - ูุงุจู ููุชุนุฏูู */
            text-align: center;
            font-size: 15px;        /* ๐ ุญุฌู ุฎุท ุงูุฌุฏูู - ูุงุจู ููุชุนุฏูู */
            font-weight: 600;
            line-height: 1.2;       /* ๐ ุชุจุงุนุฏ ุงูุณุทูุฑ ูู ุงูุฌุฏูู - ูุงุจู ููุชุนุฏูู */
            border-radius: 0 !important;
        }

        .members-table th {
            background: #004956;
            color: #ffffff;
            font-weight: 700;
            font-size: 16px;        /* ๐ ุญุฌู ุฎุท ุฑุฃุณ ุงูุฌุฏูู - ูุงุจู ููุชุนุฏูู */
            border-radius: 0 !important;
        }

        /* ๐ฅ ุชูุชูุญ ููู ุงูุชุธููู ููุฌุฏูู - ูุญุณู ููุทุจุงุนุฉ */
        .members-table tr:nth-child(even) {
            background: #E8E8E8 !important; /* ๐ฅ ููู ุฑูุงุฏู ุฃูุชุญ ููุทุจุงุนุฉ ุงูุฌูุฏุฉ */
        }

        .members-table tr:nth-child(odd) {
            background: #ffffff !important; /* ููู ุฃุจูุถ */
        }

/* ๐ฅ ุฌุฏูู ุงุนุชูุงุฏ ุงููุฏูุฑ - ุชูุณูู ูุญุณู ุจุฏูู ุฅุทุงุฑ ุฎุงุฑุฌู */
.director-approval {
    margin-top: 2mm;
    padding: 0;
    border: none;
    border-radius: 0;
    background: transparent;
}

.director-approval table {
    width: 100%;
    border-collapse: collapse;
}

.director-approval td {
    border: 2px solid #004956;     /* ๐ฅ ุฅุทุงุฑ ุณููู ููุฎูุงูุง */
    padding: 4mm;                  /* ๐ฅ ุตู ูุจูุฑ */
    text-align: center;
    font-weight: 700;
    font-size: 15px;
    color: #004956;
    line-height: 1.3;
}

        .action-buttons {
            text-align: center;
            margin: 20px 0;
        }

        .action-buttons h2 {
            color: #004956;
            margin-bottom: 15px;
        }

        .print-btn, .new-document-btn {
            padding: 15px 40px;
            border: none;
            border-radius: 50px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s;
        }

        .print-btn {
            background: linear-gradient(135deg, #004956, #d4af37);
            color: #ffffff;
        }

        .new-document-btn {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: #ffffff;
        }

        .print-btn:hover, .new-document-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* ููุงุญุธุฉ ุงูุญูุธ ูู PDF */
        .pdf-note {
            background: #e8f5e8;
            color: #2d5a2d;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #28a745;
            margin: 15px 0;
            font-size: 16px;
            text-align: center;
            font-weight: 600;
        }

        .pdf-note strong {
            color: #004956;
        }

        .pdf-note .icon {
            font-size: 18px;
            margin-left: 8px;
        }

        .footer {
            text-align: center;
            padding: 25px;
            background: #004956;
            color: #ffffff;
            border-radius: 15px;
            margin-top: 30px;
            font-size: 16px;
            border: 3px solid #d4af37;
        }

        .footer p {
            margin: 8px 0;
        }

        .footer a {
            color: #d4af37;
            text-decoration: none;
            font-weight: bold;
        }

        .footer a:hover {
            text-decoration: underline;
            color: #ffffff;
        }

        /* ุชุญุณูู ุนุฑุถ ุงููุนุงููุฉ ููุดุงุดุฉ */
        @media screen {
            .preview-container {
                page-break-inside: avoid;
            }
            
            .pdf-content {
                page-break-inside: avoid;
                page-break-after: avoid;
                page-break-before: avoid;
            }
        }

        /* ๐ฅ ุชุญุณูู ุงูุทุจุงุนุฉ - ูุน ุชุทุจูู ููุณ ุงูุชูุณูู */
        @media print {
            * {
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            @page {
                size: A4 portrait;
                margin: 0;
            }
            
            body {
                background: #ffffff !important;
                margin: 0 !important;
                padding: 0 !important;
                font-size: 12px !important;
            }
            
            .container {
                margin: 0 !important;
                padding: 0 !important;
                background: #ffffff !important;
                max-width: none !important;
            }
            
            header,
            .form-container,
            .footer,
            .action-buttons,
            .action-buttons h2,
            .print-btn,
            .new-document-btn,
            .pdf-note {
                display: none !important;
                visibility: hidden !important;
            }
            
            .preview-container {
                display: block !important;
                background: #ffffff !important;
                padding: 0 !important;
                margin: 0 !important;
                border: none !important;
                box-shadow: none !important;
                page-break-inside: avoid !important;
            }
            
            .pdf-preview {
                background: #ffffff !important;
                padding: 0 !important;
                margin: 0 !important;
                border: none !important;
                overflow: visible !important;
            }
            
            .pdf-content {
                width: 100% !important;
                height: 100vh !important;
                max-height: 297mm !important;
                box-shadow: none !important;
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
                page-break-before: avoid !important;
                margin: 0 !important;
                padding: 0 !important;
            }
            
            .official-template {
                background-image: url('template.png') !important;
                background-size: 100% 100% !important;
                background-position: center !important;
                background-repeat: no-repeat !important;
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
                width: 100% !important;
                height: 100% !important;
                page-break-inside: avoid !important;
            }
            
            /* ๐ฅ ุชุตุญูุญ ุญุฌู ุนููุงู ุงููุฌูุฉ ููุทุจุงุนุฉ */
            /* โ๏ธ ุชูุจูู: ูุฐุง ุงูุญุฌู ูุฌุจ ุฃู ูุทุงุจู ุญุฌู ุงููุนุงููุฉ ุงูุนุงุฏูุฉ */
            .committee-name-area {
                color: #ffffff !important;
                text-shadow: 2px 2px 4px rgba(0,0,0,0.8) !important;
                font-size: 22px !important;      /* ๐ฅ ูุทุงุจู ูุญุฌู ุงููุนุงููุฉ */
                font-weight: 700 !important;
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            .document-content {
                top: 35mm !important;
                left: 12mm !important;
                right: 12mm !important;
                bottom: 15mm !important;
            }
            
            /* ๐ฅ ุชุทุจูู ููุณ ุงูุชูุณูู ูู ุงูุทุจุงุนุฉ */
            .legal-text {
                font-size: 18px !important;      /* ๐ฅ ููุณ ุญุฌู ุงูุฎุท */
                line-height: 2.2 !important;     /* ๐ฅ ููุณ ุงูุชุจุงุนุฏ */
                font-weight: 700 !important;     /* ๐ฅ ููุณ ุงูุณูุงูุฉ */
                text-align: center !important;   /* ๐ฅ ููุณ ุงูุชูุณูุท */
                padding: 1mm !important;
                margin-bottom: 1mm !important;
                background: rgba(255,255,255,0.98) !important;
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            .decision-text {
                font-size: 18px !important;      /* ๐ฅ ููุณ ุญุฌู ุงูุฎุท */
                line-height: 1.8 !important;     /* ๐ฅ ููุณ ุงูุชุจุงุนุฏ */
                font-weight: 700 !important;     /* ๐ฅ ููุณ ุงูุณูุงูุฉ */
                text-align: center !important;   /* ๐ฅ ููุณ ุงูุชูุณูุท */
                padding: 3mm !important;
                margin-bottom: 4mm !important;
                background: rgba(255,255,255,0.98) !important;
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            .members-table {
                background: rgba(255,255,255,0.98) !important;
                border-radius: 0 !important;
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            .members-table th,
            .members-table td {
                font-size: 11px !important;
                padding: 2mm !important;
                line-height: 1.1 !important;
                border: 1px solid #004956 !important;
                border-radius: 0 !important;
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            .members-table th {
                background: #004956 !important;
                color: #ffffff !important;
                font-size: 12px !important;
                font-weight: 700 !important;
                border-radius: 0 !important;
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            /* ๐ฅ ุชุทุจูู ุงูููู ุงูุฑูุงุฏู ุงูุฃูุชุญ ูู ุงูุทุจุงุนุฉ */
            .members-table tr:nth-child(even) {
                background: #E8E8E8 !important;  /* ๐ฅ ููุณ ุงูููู ุงูุฃูุชุญ */
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
            .members-table tr:nth-child(odd) {
                background: #ffffff !important;
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            
/* ๐ฅ ุฌุฏูู ุงุนุชูุงุฏ ุงููุฏูุฑ - ุชูุณูู ุงูุทุจุงุนุฉ */
.director-approval {
    margin-top: 2mm !important;
    padding: 0 !important;
    border: none !important;
    border-radius: 0 !important;
    background: transparent !important;
}

.director-approval table {
    width: 100% !important;
    border-collapse: collapse !important;
}

.director-approval td {
    border: 2px solid #004956 !important;  /* ๐ฅ ุฅุทุงุฑ ุณููู ูุทุงุจู */
    padding: 4mm !important;                /* ๐ฅ ุญุฌู ููุงุณุจ ููุทุจุงุนุฉ */
    text-align: center !important;
    font-weight: 700 !important;
    font-size: 13px !important;
    color: #004956 !important;
    line-height: 1.3 !important;
    -webkit-print-color-adjust: exact !important;
    color-adjust: exact !important;
    print-color-adjust: exact !important;
}
            
            .document-content > div:last-child {
                margin-top: 3mm !important;
                font-size: 10px !important;
                -webkit-print-color-adjust: exact !important;
                color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
        }

        .member-row input[data-field="name"] {
            text-align: center;
            font-weight: 600;
            font-size: 17px;
            background: #f8f9fa;
            border: 2px solid #004956;
        }

        .member-row input[data-field="name"]:focus {
            background: #ffffff;
            border-color: #d4af37;
            box-shadow: 0 0 5px rgba(0,73,86,0.3);
        }

        .member-row select {
            text-align: center;
            font-weight: 600;
        }

        .members-table th,
        .members-table td {
            border: 1px solid #004956;
            padding: 2mm;
            text-align: center;
            font-size: 13px;
            font-weight: 600;
            line-height: 1.2;
            border-radius: 0 !important;
        }

        .members-table th {
            background: #004956;
            color: #ffffff;
            font-weight: 700;
            font-size: 14px;
            padding: 2.5mm;
            border-radius: 0 !important;
        }

        .members-table th:last-child,
        .members-table td:last-child {
            width: 30mm;
            min-width: 30mm;
        }

        @media (max-width: 768px) {
            .member-row {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .settings-grid {
                grid-template-columns: 1fr;
            }
            
            .gender-options {
                flex-direction: column;
                gap: 15px;
            }
            
            .pdf-content {
                width: 100%;
                height: auto;
                min-height: 297mm;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ูููุฐุฌ ูุฑุงุฑ ุชุดููู ุงููุฌุงู ูุงููุฑู ุงููุฏุฑุณูุฉ</h1>
            <p>ุฃูุดุฆ ูุฑุงุฑุงุช ุชุดููู ุงููุฌุงู ุงููุฏุฑุณูุฉ ุจุณูููุฉ ูุณุฑุนุฉ</p>
        </header>

        <div class="form-container" id="formContainer">
            <!-- ูุนูููุงุช ุงููุฏุฑุณุฉ -->
            <div class="section">
                <h2>๐ ูุนูููุงุช ุงููุฏุฑุณุฉ</h2>
                <div class="input-group">
                    <label for="schoolName">ุงุณู ุงููุฏุฑุณุฉ:</label>
                    <input type="text" id="schoolName" placeholder="ุงูุชุจ ุงุณู ุงููุฏุฑุณุฉ">
                </div>
                <div class="input-group">
                    <label>ููุน ุงููุฏุฑุณุฉ:</label>
                    <div class="gender-options">
                        <div class="gender-option" onclick="selectGender('boys')">
                            <input type="radio" name="schoolGender" value="boys" id="boys">
                            <label for="boys">ูุฏุฑุณุฉ ุจููู</label>
                        </div>
                        <div class="gender-option" onclick="selectGender('girls')">
                            <input type="radio" name="schoolGender" value="girls" id="girls">
                            <label for="girls">ูุฏุฑุณุฉ ุจูุงุช</label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ุงุฎุชูุงุฑ ุงููุฌูุฉ -->
            <div class="section">
                <h2>๐ฏ ุงุฎุชูุงุฑ ุงููุฌูุฉ</h2>
                <div class="committee-selector">
                    <select id="committeeType">
                        <option value="">ุงุฎุชุฑ ุงููุฌูุฉ ุฃู ุงููุฑูู</option>
                        <option value="ุฅุฏุงุฑูุฉ">ุงููุฌูุฉ ุงูุฅุฏุงุฑูุฉ ูููุฏุฑุณุฉ</option>
                        <option value="ุชูุฌูู">ูุฌูุฉ ุงูุชูุฌูู ูุงูุฅุฑุดุงุฏ</option>
                        <option value="ุชุญุตูู">ูุฌูุฉ ุงูุชุญุตูู ุงูุฏุฑุงุณู</option>
                        <option value="ุชููุฒ">ูุฌูุฉ ุงูุชููุฒ</option>
                        <option value="ุตูุฏูู">ูุฑูู ุงูุตูุฏูู ุงููุฏุฑุณู</option>
                        <option value="ุฃูู">ูุฑูู ุงูุฃูู ูุงูุณูุงูุฉ</option>
                        <option value="ุชุฑุจูุฉ_ุฎุงุตุฉ">ูุฑูู ุงูุชุฑุจูุฉ ุงูุฎุงุตุฉ</option>
                    </select>
                </div>
            </div>

            <!-- ุชูุงุตูู ุงูุฃุนุถุงุก -->
            <div class="section" id="membersSection" style="display: none;">
                <h2>๐ฅ ุชูุงุตูู ุงูุฃุนุถุงุก</h2>
                <div id="membersContainer">
                    <!-- ุณูุชู ุฅูุดุงุก ุงูุฃุนุถุงุก ููุง ุจูุงุณุทุฉ JavaScript -->
                </div>
            </div>

            <!-- ุฅุนุฏุงุฏุงุช ุฅุถุงููุฉ -->
            <div class="section">
                <h2>โ๏ธ ุฅุนุฏุงุฏุงุช ุฅุถุงููุฉ</h2>
                <div class="settings-grid">
                    <div class="input-group">
                        <label for="academicYear">ุงูุนุงู ุงูุฏุฑุงุณู:</label>
                        <input type="text" id="academicYear" value="1447ูู">
                    </div>
                    <div class="input-group">
                        <label for="decisionDate">ุชุงุฑูุฎ ุงููุฑุงุฑ:</label>
                        <input type="date" id="decisionDate">
                    </div>
                    <div class="input-group">
                        <!-- ๐ฅ ุชุบููุฑ ุงููุต ุญุณุจ ุงูุฌูุณ -->
                        <label for="directorName" id="directorLabel">ุงุณู ูุฏูุฑ ุงููุฏุฑุณุฉ:</label>
                        <input type="text" id="directorName" placeholder="ุงุณู ูุฏูุฑ ุงููุฏุฑุณุฉ">
                    </div>
                </div>
            </div>

            <!-- ุฒุฑ ุงูุฅูุดุงุก -->
            <div class="action-section">
                <button id="previewBtn" class="preview-btn action-btn">๐๏ธ ูุนุงููุฉ ุงููุฑุงุฑ</button>
            </div>

            <!-- ุชูุจูู ุงูุญูุธ -->
            <div class="warning-message">
                <strong>ุชูุจูู:</strong> ูุฑุฌู ุญูุธ ุงููููุฐุฌ ุฃู ุทุจุงุนุชู ูุจู ุงุฎุชูุงุฑ ูุฌูุฉ ุฃุฎุฑูุ ุญูุซ ุณูุชู ุญุฐู ุงูุจูุงูุงุช ุงููุฏุฎูุฉ ุนูุฏ ุชุบููุฑ ุงููุฌูุฉ.
            </div>
        </div>

        <!-- ูุนุงููุฉ ุงููุฑุงุฑ -->
        <div class="preview-container" id="previewContainer" style="display: none;">
            <div class="action-buttons">
                <h2>๐ ูุนุงููุฉ ุงููุฑุงุฑ</h2>
                <button class="print-btn" onclick="printDocument()">๐จ๏ธ ุทุจุงุนุฉ</button>
                <button class="new-document-btn" onclick="createNewDocument()">๐ ูุฑุงุฑ ุฌุฏูุฏ</button>
            </div>
            
            <!-- ููุงุญุธุฉ ุญูุธ PDF -->
            <div class="pdf-note">
                <span class="icon">๐ก</span>
                <strong>ุชูููุญ:</strong> ูุญูุธ ุงูููู ุจุตูุบุฉ PDFุ ุงุถุบุท ุนูู ุฒุฑ ุงูุทุจุงุนุฉ ูุงุฎุชุฑ "ุญูุธ ูููู PDF" ุฃู "Microsoft Print to PDF" ูู ุฎูุงุฑุงุช ุงูุทุงุจุนุฉ
            </div>
            
            <div class="pdf-preview">
                <div id="pdfContent" class="pdf-content">
                    <!-- ุณูุชู ุฅูุดุงุก ุงููุญุชูู ููุง -->
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p><strong>ุฌููุน ุงูุญููู ูุญููุธุฉ - ูุชุฌุฑ ุนุฑูู ุงูุฐูุจ ููููุชุฌุงุช ุงูุฑูููุฉ</strong></p>
            <p>ยฉGoldenVeinsHQ 2025 - ุงูุฅุตุฏุงุฑ 1.6</p>
            <p>ููุชูุงุตู: <a href="https://goldenveinshq.carrd.co/" target="_blank">goldenveinshq.carrd.co</a></p>
        </div>
    </div>
<script>
    // ูุงุนุฏุฉ ุจูุงูุงุช ุงููุฌุงู
    const committees = {
        "ุฅุฏุงุฑูุฉ": {
            name: "ุงููุฌูุฉ ุงูุฅุฏุงุฑูุฉ ูููุฏุฑุณุฉ",
            structure: {
                chairman: "ูุฏูุฑ ุงููุฏุฑุณุฉ",
                members: ["ูููู ุงููุฏุฑุณุฉ", "ุงูููุฌู ุงูุทูุงุจู", "ุฑุงุฆุฏ ุงููุดุงุท", "ูุนูู", "ูุนูู", "ูุนูู"],
                secretary: "ูุณุงุนุฏ ุฅุฏุงุฑู"
            }
        },
        "ุชูุฌูู": {
            name: "ูุฌูุฉ ุงูุชูุฌูู ูุงูุฅุฑุดุงุฏ",
            structure: {
                chairman: "ูููู ุงููุฏุฑุณุฉ",
                members: ["ูููู ุงููุฏุฑุณุฉ", "ูุนูู", "ูุนูู", "ูุนูู"],
                secretary: "ุงูููุฌู ุงูุทูุงุจู"
            }
        },
        "ุชุญุตูู": {
            name: "ูุฌูุฉ ุงูุชุญุตูู ุงูุฏุฑุงุณู",
            structure: {
                chairman: "ูุฏูุฑ ุงููุฏุฑุณุฉ",
                vice_chairman: "ูููู ุงููุฏุฑุณุฉ",
                members: ["ูููู ุงููุฏุฑุณุฉ", "ุฑุงุฆุฏ ุงููุดุงุท", "ูุนูู", "ูุนูู", "ูุนูู"],
                secretary: "ุงูููุฌู ุงูุทูุงุจู"
            }
        },
        "ุชููุฒ": {
            name: "ูุฌูุฉ ุงูุชููุฒ",
            structure: {
                chairman: "ูุฏูุฑ ุงููุฏุฑุณุฉ",
                members: ["ูููู ุงููุฏุฑุณุฉ", "ูููู ุงููุฏุฑุณุฉ", "ุงูููุฌู ุงูุทูุงุจู", "ูุนูู", "ูุนูู", "ูุนูู"],
                secretary: "ุฑุงุฆุฏ ุงููุดุงุท"
            }
        },
        "ุตูุฏูู": {
            name: "ูุฑูู ุงูุตูุฏูู ุงููุฏุฑุณู",
            structure: {
                chairman: "ูููู ุงููุฏุฑุณุฉ",
                members: ["ุงูููุฌู ุงูุทูุงุจู", "ุฑุงุฆุฏ ุงููุดุงุท", "ูุนูู"],
                secretary: "ูุณุงุนุฏ ุฅุฏุงุฑู"
            }
        },
        "ุฃูู": {
            name: "ูุฑูู ุงูุฃูู ูุงูุณูุงูุฉ ุจุงููุฏุฑุณุฉ",
            structure: {
                chairman: "ูููู ุงููุฏุฑุณุฉ",
                members: ["ุงูููุฌู ุงูุทูุงุจู", "ุงูููุฌู ุงูุตุญู", "ูุนูู", "ูุนูู"]
            }
        },
        "ุชุฑุจูุฉ_ุฎุงุตุฉ": {
            name: "ูุฑูู ุงูุชุฑุจูุฉ ุงูุฎุงุตุฉ",
            structure: {
                chairman: "ูููู ุงููุฏุฑุณุฉ",
                members: ["ุงูููุฌู ุงูุทูุงุจู", "ุงูููุฌู ุงูุตุญู", "ูุนูู", "ูุนูู"],
                secretary: "ูุนูู ุงูุชุฑุจูุฉ ุงูุฎุงุตุฉ"
            }
        }
    };

    // ูุงุฆูุฉ ุงูุฃุฏูุงุฑ ููุจููู ูุงูุจูุงุช
    const rolesByGender = {
        boys: {
            "ูุฏูุฑ ุงููุฏุฑุณุฉ": "ูุฏูุฑ ุงููุฏุฑุณุฉ",
            "ูููู ุงููุฏุฑุณุฉ": "ูููู ุงููุฏุฑุณุฉ",
            "ูููู ุงูุดุคูู ุงูุชุนููููุฉ": "ูููู ุงูุดุคูู ุงูุชุนููููุฉ",
            "ูููู ุดุคูู ุงูุทูุงุจ": "ูููู ุดุคูู ุงูุทูุงุจ",
            "ูููู ุงูุดุคูู ุงููุฏุฑุณูุฉ": "ูููู ุงูุดุคูู ุงููุฏุฑุณูุฉ",
            "ุงูููุฌู ุงูุทูุงุจู": "ุงูููุฌู ุงูุทูุงุจู",
            "ุฑุงุฆุฏ ุงููุดุงุท": "ุฑุงุฆุฏ ุงููุดุงุท",
            "ุงูููุฌู ุงูุตุญู": "ุงูููุฌู ุงูุตุญู",
            "ูุนูู ุงูุชุฑุจูุฉ ุงูุฎุงุตุฉ": "ูุนูู ุงูุชุฑุจูุฉ ุงูุฎุงุตุฉ",
            "ูุณุงุนุฏ ุฅุฏุงุฑู": "ูุณุงุนุฏ ุฅุฏุงุฑู",
            "ูุนูู": "ูุนูู",
            "ูุญุถุฑ ุงููุฎุชุจุฑ": "ูุญุถุฑ ุงููุฎุชุจุฑ",
            "ุฃููู ูุตุงุฏุฑ ุงูุชุนูู": "ุฃููู ูุตุงุฏุฑ ุงูุชุนูู"
        },
        girls: {
            "ูุฏูุฑ ุงููุฏุฑุณุฉ": "ูุฏูุฑุฉ ุงููุฏุฑุณุฉ",
            "ูููู ุงููุฏุฑุณุฉ": "ููููุฉ ุงููุฏุฑุณุฉ",
            "ูููู ุงูุดุคูู ุงูุชุนููููุฉ": "ููููุฉ ุงูุดุคูู ุงูุชุนููููุฉ",
            "ูููู ุดุคูู ุงูุทูุงุจ": "ููููุฉ ุดุคูู ุงูุทุงูุจุงุช",
            "ูููู ุงูุดุคูู ุงููุฏุฑุณูุฉ": "ููููุฉ ุงูุดุคูู ุงููุฏุฑุณูุฉ",
            "ุงูููุฌู ุงูุทูุงุจู": "ุงูููุฌูุฉ ุงูุทูุงุจูุฉ",
            "ุฑุงุฆุฏ ุงููุดุงุท": "ุฑุงุฆุฏุฉ ุงููุดุงุท",
            "ุงูููุฌู ุงูุตุญู": "ุงูููุฌูุฉ ุงูุตุญูุฉ",
            "ูุนูู ุงูุชุฑุจูุฉ ุงูุฎุงุตุฉ": "ูุนููุฉ ุงูุชุฑุจูุฉ ุงูุฎุงุตุฉ",
            "ูุณุงุนุฏ ุฅุฏุงุฑู": "ูุณุงุนุฏุฉ ุฅุฏุงุฑูุฉ",
            "ูุนูู": "ูุนููุฉ",
            "ูุญุถุฑ ุงููุฎุชุจุฑ": "ูุญุถุฑุฉ ุงููุฎุชุจุฑ",
            "ุฃููู ูุตุงุฏุฑ ุงูุชุนูู": "ุฃูููุฉ ูุตุงุฏุฑ ุงูุชุนูู"
        }
    };

    // ูุงุฆูุฉ ุงูููุงู ุงููููู ุจูุง
    const taskRoles = [
        "ุฑุฆูุณ",
        "ูุงุฆุจ ุงูุฑุฆูุณ",
        "ุนุถู",
        "ุนุถู ูููุฑุฑ",
        "ููุฑุฑ"
    ];

    // ูุชุบูุฑุงุช ุนุงูุฉ
    let currentCommittee = null;
    let currentGender = 'boys';
    let membersData = [];
    let memberIdCounter = 0;

    // ุชููุฆุฉ ุงูุชุทุจูู
    document.addEventListener('DOMContentLoaded', function() {
        // ุฅุนุฏุงุฏ ุงูุชุงุฑูุฎ ุงูุญุงูู
        const today = new Date();
        const formattedDate = today.toISOString().split('T')[0];
        document.getElementById('decisionDate').value = formattedDate;
        
        // ุชุญุฏูุฏ ุงูุฌูุณ ุงูุงูุชุฑุงุถู
        document.getElementById('boys').checked = true;
        document.querySelector('.gender-option').classList.add('selected');
        
        // ุชุญุฏูุซ ุงููุตูุต ุญุณุจ ุงูุฌูุณ ุงูุงูุชุฑุงุถู
        updateGenderTexts('boys');
        
        // ุฑุจุท ุงูุฃุญุฏุงุซ
        document.getElementById('committeeType').addEventListener('change', function() {
            if (this.value !== currentCommittee && currentCommittee !== null) {
                const confirmChange = confirm('ุณูุชู ุญุฐู ุงูุจูุงูุงุช ุงููุฏุฎูุฉ. ูู ุชุฑูุฏ ุงููุชุงุจุนุฉุ');
                if (!confirmChange) {
                    this.value = currentCommittee;
                    return;
                }
            }
            
            currentCommittee = this.value;
            if (currentCommittee) {
                document.getElementById('membersSection').style.display = 'block';
                generateMembersForm();
            } else {
                document.getElementById('membersSection').style.display = 'none';
            }
        });

        document.getElementById('previewBtn').addEventListener('click', showPreview);
    });

    // ๐ฅ ุชุญุฏูุซ ุงููุตูุต ุญุณุจ ุงูุฌูุณ
    function updateGenderTexts(gender) {
        const directorLabel = document.getElementById('directorLabel');
        const directorInput = document.getElementById('directorName');
        
        if (gender === 'girls') {
            directorLabel.textContent = 'ุงุณู ูุฏูุฑุฉ ุงููุฏุฑุณุฉ:';
            directorInput.placeholder = 'ุงุณู ูุฏูุฑุฉ ุงููุฏุฑุณุฉ';
        } else {
            directorLabel.textContent = 'ุงุณู ูุฏูุฑ ุงููุฏุฑุณุฉ:';
            directorInput.placeholder = 'ุงุณู ูุฏูุฑ ุงููุฏุฑุณุฉ';
        }
    }

    // ุงุฎุชูุงุฑ ุฌูุณ ุงููุฏุฑุณุฉ
    function selectGender(gender) {
        currentGender = gender;
        
        // ุชุญุฏูุซ ุงููุงุฌูุฉ
        document.querySelectorAll('.gender-option').forEach(option => {
            option.classList.remove('selected');
        });
        
        document.querySelector(`[onclick="selectGender('${gender}')"]`).classList.add('selected');
        document.getElementById(gender).checked = true;
        
        // ๐ฅ ุชุญุฏูุซ ุงููุตูุต ุญุณุจ ุงูุฌูุณ ุงููุฎุชุงุฑ
        updateGenderTexts(gender);
        
        // ุฅุนุงุฏุฉ ุฅูุดุงุก ุงููููุฐุฌ ุฅุฐุง ูุงู ููุงู ูุฌูุฉ ูุญุฏุฏุฉ
        if (currentCommittee) {
            generateMembersForm();
        }
    }

    // ุฅูุดุงุก ูููุฐุฌ ุงูุฃุนุถุงุก
    function generateMembersForm() {
        const container = document.getElementById('membersContainer');
        container.innerHTML = '';
        
        const committee = committees[currentCommittee];
        membersData = [];
        memberIdCounter = 0;
        
        // ุฅุถุงูุฉ ุงูุฑุฆูุณ
        if (committee.structure.chairman) {
            const memberData = createMemberData(committee.structure.chairman, "ุฑุฆูุณ");
            membersData.push(memberData);
            container.appendChild(createMemberRow(memberData, false));
        }
        
        // ุฅุถุงูุฉ ูุงุฆุจ ุงูุฑุฆูุณ
        if (committee.structure.vice_chairman) {
            const memberData = createMemberData(committee.structure.vice_chairman, "ูุงุฆุจ ุงูุฑุฆูุณ");
            membersData.push(memberData);
            container.appendChild(createMemberRow(memberData, false));
        }
        
        // ุฅุถุงูุฉ ุงูุฃุนุถุงุก
        committee.structure.members.forEach(member => {
            const memberData = createMemberData(member, "ุนุถู");
            membersData.push(memberData);
            container.appendChild(createMemberRow(memberData, true));
        });
        
        // ุฅุถุงูุฉ ุงูููุฑุฑ
        if (committee.structure.secretary) {
            const memberData = createMemberData(committee.structure.secretary, "ููุฑุฑ");
            membersData.push(memberData);
            container.appendChild(createMemberRow(memberData, false));
        }
        
        // ุฅุถุงูุฉ ุฒุฑ ุฅุถุงูุฉ ุนุถู ุฌุฏูุฏ
        const addBtn = document.createElement('button');
        addBtn.className = 'add-member-btn';
        addBtn.innerHTML = '+';
        addBtn.title = 'ุฅุถุงูุฉ ุนุถู ุฌุฏูุฏ';
        addBtn.onclick = addNewMember;
        container.appendChild(addBtn);
    }

    // ุฅูุดุงุก ุจูุงูุงุช ุงูุนุถู
    function createMemberData(defaultRole, position) {
        const genderizedRole = rolesByGender[currentGender][defaultRole] || defaultRole;
        return {
            id: memberIdCounter++,
            name: "",
            jobTitle: genderizedRole,
            position: position,
            isAddedByUser: false
        };
    }

    // ุฅูุดุงุก ุตู ุงูุนุถู
    function createMemberRow(memberData, canDelete = false) {
        const row = document.createElement('div');
        row.className = 'member-row';
        row.dataset.memberId = memberData.id;
        
        // ุฅูุดุงุก ูุงุฆูุฉ ุงูุฃุฏูุงุฑ
        const currentRoles = rolesByGender[currentGender];
        let roleOptions = '';
        Object.values(currentRoles).forEach(role => {
            const selected = role === memberData.jobTitle ? 'selected' : '';
            roleOptions += `<option value="${role}" ${selected}>${role}</option>`;
        });
        
        // ุฅูุดุงุก ูุงุฆูุฉ ุงูููุงู
        let taskOptions = '';
        taskRoles.forEach(task => {
            const selected = task === memberData.position ? 'selected' : '';
            taskOptions += `<option value="${task}" ${selected}>${task}</option>`;
        });
        
        // ุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ูููู ุญุฐู ุงูุนุถู
        const showDeleteBtn = canDelete || memberData.isAddedByUser;
        
        row.innerHTML = `
            <input type="text" placeholder="ุงุณู ุงูุนุถู" value="${memberData.name}" data-field="name">
            <select data-field="jobTitle">
                ${roleOptions}
            </select>
            <select data-field="position">
                ${taskOptions}
            </select>
            <div class="role-label">${memberData.position}</div>
            ${showDeleteBtn ? '<button class="remove-member-btn" onclick="removeMember(this)">ร</button>' : ''}
        `;
        
        // ุฑุจุท ุงูุฃุญุฏุงุซ
        row.querySelector('input[data-field="name"]').addEventListener('input', function() {
            updateMemberData(memberData.id, 'name', this.value);
        });
        
        row.querySelector('select[data-field="jobTitle"]').addEventListener('change', function() {
            updateMemberData(memberData.id, 'jobTitle', this.value);
        });
        
        row.querySelector('select[data-field="position"]').addEventListener('change', function() {
            updateMemberData(memberData.id, 'position', this.value);
            const roleLabel = row.querySelector('.role-label');
            roleLabel.textContent = this.value;
        });
        
        return row;
    }

    // ุชุญุฏูุซ ุจูุงูุงุช ุงูุนุถู
    function updateMemberData(memberId, field, value) {
        const memberIndex = membersData.findIndex(m => m.id === memberId);
        if (memberIndex !== -1) {
            membersData[memberIndex][field] = value;
        }
    }

    // ุฅุถุงูุฉ ุนุถู ุฌุฏูุฏ
    function addNewMember() {
        const memberData = createMemberData("ูุนูู", "ุนุถู");
        memberData.isAddedByUser = true;
        membersData.push(memberData);
        
        const container = document.getElementById('membersContainer');
        const addBtn = container.querySelector('.add-member-btn');
        container.insertBefore(createMemberRow(memberData, true), addBtn);
    }

    // ุญุฐู ุนุถู
    function removeMember(button) {
        const row = button.closest('.member-row');
        const memberId = parseInt(row.dataset.memberId);
        
        membersData = membersData.filter(m => m.id !== memberId);
        row.remove();
    }

    // ุนุฑุถ ุงููุนุงููุฉ
    function showPreview() {
        const schoolName = document.getElementById('schoolName').value;
        const directorName = document.getElementById('directorName').value;
        const selectedGender = document.querySelector('input[name="schoolGender"]:checked');
        
        if (!schoolName || !directorName || !currentCommittee || !selectedGender) {
            alert('ูุฑุฌู ููุก ุฌููุน ุงูุญููู ุงููุทููุจุฉ');
            return;
        }
        
        const emptyMembers = membersData.filter(member => !member.name);
        if (emptyMembers.length > 0) {
            alert('ูุฑุฌู ููุก ุฃุณูุงุก ุฌููุน ุงูุฃุนุถุงุก');
            return;
        }
        
        const previewContent = generatePreviewContent();
        document.getElementById('pdfContent').innerHTML = previewContent;
        document.getElementById('formContainer').style.display = 'none';
        document.getElementById('previewContainer').style.display = 'block';
        document.getElementById('previewContainer').scrollIntoView({ behavior: 'smooth' });
    }

    // ุฅูุดุงุก ูุญุชูู ุงููุนุงููุฉ
    function generatePreviewContent() {
        const schoolName = document.getElementById('schoolName').value;
        const academicYear = document.getElementById('academicYear').value;
        const decisionDate = document.getElementById('decisionDate').value;
        const directorName = document.getElementById('directorName').value;
        const committeeName = committees[currentCommittee].name;
        
        const hijriDate = convertToHijri(decisionDate);
        
        const directorTitle = currentGender === 'girls' ? 'ูุฏูุฑุฉ ุงููุฏุฑุณุฉ' : 'ูุฏูุฑ ุงููุฏุฑุณุฉ';
        const directorApproval = currentGender === 'girls' ? 'ูุนุชูุฏ ูุฏูุฑุฉ ุงููุฏุฑุณุฉ' : 'ูุนุชูุฏ ูุฏูุฑ ุงููุฏุฑุณุฉ';
        const permissionText = currentGender === 'girls' ? 'ุงูููููุญุฉ ููุฏูุฑุฉ ุงููุฏุฑุณุฉ' : 'ุงูููููุญุฉ ููุฏูุฑ ุงููุฏุฑุณุฉ';
        
        let tableRows = '';
        membersData.forEach((member, index) => {
            tableRows += `
                <tr>
                    <td>${member.name}</td>
                    <td>${member.jobTitle}</td>
                    <td>${member.position}</td>
                    <td style="width: 45mm; height: 12mm;"></td>
                </tr>
            `;
        });
        
        return `
            <div class="official-template">
                <div class="committee-name-area">
                    ${committeeName}
                </div>
                
                <div class="document-content">
                    <div class="legal-text">
                        ุงุณุชูุงุฏุงู ุนูู ุงูุตูุงุญูุฉ ุฑูู (1) ุงููุงุฑุฏุฉ ูู ุฏููู ุงูุตูุงุญูุงุช ${permissionText} ุจุงููุฑุงุฑ ุงููุฒุงุฑู ุฑูู 37617168 ูุชุงุฑูุฎ 1437/4/1ูู. ูุงุณุชูุงุฏุงู ุฅูู ูุง ูุฑุฏ ูู ุงูุฏููู ุงูุชูุธููู ููุฏุงุฑุณ ุงูุชุนููู ููุนุงู 1442ูู ููุฏ ุชูุฑุฑ ูุง ููู:
                    </div>
                    
                    <div class="decision-text">
                        ุงุนุชูุงุฏ ุชุดููู ${committeeName} ููุนุงู ุงูุฏุฑุงุณู ${academicYear} ูููุงู ููุฌุฏูู ุงูุชุงูู:
                    </div>
                    
                    <table class="members-table">
                        <thead>
                            <tr>
                                <th>ุงูุงุณู</th>
                                <th>ุงููุตู ุงููุธููู</th>
                                <th>ุงููููุฉ ุงููููู ุจูุง</th>
                                <th>ุงูุชูููุน</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${tableRows}
                        </tbody>
                    </table>
                    
                    <div class="director-approval">
                        <table>
                            <tr>
                                <td style="width: 25%;">${directorApproval}</td>
                                <td style="width: 50%;">${directorName}</td>
                                <td style="width: 25%;"></td>
                            </tr>
                        </table>
                    </div>
                    
                    <div style="text-align: center; margin-top: 10mm; font-size: 14px; color: #004956; font-weight: 600;">
                        ุงูุชุงุฑูุฎ: ${hijriDate}
                    </div>
                </div>
            </div>
        `;
    }

    // ุฅูุดุงุก ูุฑุงุฑ ุฌุฏูุฏ
    function createNewDocument() {
        document.getElementById('formContainer').style.display = 'block';
        document.getElementById('previewContainer').style.display = 'none';
        document.getElementById('formContainer').scrollIntoView({ behavior: 'smooth' });
    }

    // ุชุญููู ุชูุฑูุจู ููุชุงุฑูุฎ ุงููุฌุฑู
    function convertToHijri(gregorianDate) {
        if (!gregorianDate) return "";
        
        const date = new Date(gregorianDate);
        const day = date.getDate();
        const month = date.getMonth() + 1;
        const year = date.getFullYear();
        
        const hijriYear = year - 579;
        
        const hijriMonths = [
            "ูุญุฑู", "ุตูุฑ", "ุฑุจูุน ุงูุฃูู", "ุฑุจูุน ุงูุขุฎุฑ", "ุฌูุงุฏู ุงูุฃููู", "ุฌูุงุฏู ุงูุขุฎุฑุฉ",
            "ุฑุฌุจ", "ุดุนุจุงู", "ุฑูุถุงู", "ุดูุงู", "ุฐู ุงููุนุฏุฉ", "ุฐู ุงูุญุฌุฉ"
        ];
        
        return `${day}/${hijriMonths[month - 1]}/${hijriYear}ูู`;
    }

    // ๐ฅ ุฏุงูุฉ ุทุจุงุนุฉ ูุญุณูุฉ ูุน ุชุนููู ุงุณู ุงูููู
    function printDocument() {
        if (!document.getElementById('pdfContent').innerHTML) {
            alert('ูุฑุฌู ุฅูุดุงุก ุงููุนุงููุฉ ุฃููุงู');
            return;
        }

        // ๐ฅ ุชุญุฏูุฏ ุงุณู ุงูููู ุญุณุจ ุงููุฌูุฉ
        const committeeName = committees[currentCommittee].name;
        const schoolName = document.getElementById('schoolName').value;
        const academicYear = document.getElementById('academicYear').value;
        const fileName = `${committeeName}_${schoolName}_${academicYear}`;

        // ๐ฅ ุชุนููู ุนููุงู ุงูุตูุญุฉ (ุงุณู ุงูููู ุงูุงูุชุฑุงุถู)
        const originalTitle = document.title;
        document.title = fileName;

        // ุฅุฎูุงุก ุงูุนูุงุตุฑ ุบูุฑ ุงููุทููุจุฉ ููุทุจุงุนุฉ
        const elementsToHide = [
            document.querySelector('.action-buttons'),
            document.querySelector('header'),
            document.querySelector('.form-container'),
            document.querySelector('.footer'),
            document.querySelector('.pdf-note')
        ];

        elementsToHide.forEach(element => {
            if (element) {
                element.style.display = 'none';
            }
        });

        // ุฅุถุงูุฉ ุฃููุงุท ุงูุทุจุงุนุฉ ุงููุคูุชุฉ
        const tempPrintStyle = document.createElement('style');
        tempPrintStyle.id = 'temp-print-style';
        tempPrintStyle.textContent = `
            @media print {
                body * {
                    visibility: hidden;
                }
                
                .preview-container,
                .preview-container * {
                    visibility: visible;
                }
                
                .preview-container {
                    position: absolute;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    margin: 0;
                    padding: 0;
                    background: white;
                }
                
                .pdf-content {
                    width: 100% !important;
                    height: 100vh !important;
                    margin: 0 !important;
                    padding: 0 !important;
                    box-shadow: none !important;
                }
                
                .official-template {
                    background-image: url('template.png') !important;
                    background-size: 100% 100% !important;
                    background-repeat: no-repeat !important;
                    -webkit-print-color-adjust: exact !important;
                    print-color-adjust: exact !important;
                }
                
                .members-table,
                .members-table th,
                .members-table td {
                    border-radius: 0 !important;
                }
                
                /* ๐ฅ ุถูุงู ุธููุฑ ููู ุงูุชุธููู ุงูุฌุฏูุฏ */
                .members-table tr:nth-child(even) {
                    background: #E8E8E8 !important;
                    -webkit-print-color-adjust: exact !important;
                    print-color-adjust: exact !important;
                }
                
                .members-table tr:nth-child(odd) {
                    background: #ffffff !important;
                    -webkit-print-color-adjust: exact !important;
                    print-color-adjust: exact !important;
                }
            }
        `;
        document.head.appendChild(tempPrintStyle);

        // ุชูููุฐ ุงูุทุจุงุนุฉ
        setTimeout(() => {
            window.print();
            
            // ุฅุฒุงูุฉ ุงูุฃููุงุท ุงููุคูุชุฉ ูุฅุนุงุฏุฉ ุฅุธูุงุฑ ุงูุนูุงุตุฑ
            setTimeout(() => {
                document.head.removeChild(tempPrintStyle);
                document.title = originalTitle; // ุฅุนุงุฏุฉ ุงูุนููุงู ุงูุฃุตูู
                
                elementsToHide.forEach(element => {
                    if (element) {
                        element.style.display = '';
                    }
                });
            }, 1000);
        }, 100);
    }
</script>
</body>
</html>